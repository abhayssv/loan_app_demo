(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{"0zSO":function(t,e,n){"use strict";n.r(e);var o=n("mrSG"),r=n("CcnG"),i=n("Ip0R"),s=n("gIcY"),a=n("ZYCi"),l=n("t/Na"),p=n("F/XL"),c=n("xMyE"),d=n("9Z1F"),u=n("AytR"),h=n("3AtW"),m=function(){function t(t,e){this.http=t,this.alertService=e,this.requestUrl=u.a.requestUrl+"/api/apply_loan",this.httpOptions={headers:new l.d({"content-Type":"application/json;charset=UTF-8"})}}return t.prototype.getCollectionReports=function(){var t=this;return this.http.get(u.a.requestUrl+"/api/system_report/collection/get_collections").pipe(Object(c.a)((function(e){t.handleResponse(e)})),Object(d.a)(this.handleError("CollectionReport")))},t.prototype.getCollectionLoanReport=function(t,e){var n=this;return this.http.get(u.a.requestUrl+"/api/system_report/collection/get_collections_report/"+t+"/"+e).pipe(Object(c.a)((function(t){n.handleResponse(t)})),Object(d.a)(this.handleError("OverallCollection")))},t.prototype.getCollectionReport=function(t,e,n,o){var r=this,i=t.from_date,s=t.to_date,a=t.collection_team,l=t.assigned_users,p=t.loan_id,h=t.name,m=t.mobile_no,g=t.email,b=t.amount,f=t.id_number,y=t.tenure,v=t.user_type;return this.http.get(u.a.requestUrl+"/api/system_report/collection/get_reports?from_date="+i+"&to_date="+s+"&collection_team="+a+"&assigned_users="+l+"&loan_id="+p+"&name="+h+"&mobile_no="+m+"&email="+g+"&amount="+b+"&id_number="+f+"&tenure="+y+"&user_type="+v+"&offset="+e+"&limit="+n+"&isExport="+o).pipe(Object(c.a)((function(t){r.handleResponse(t)})),Object(d.a)(this.handleError("CollectionReport")))},t.prototype.getCollectionReportView=function(t){var e=this;return this.http.get(u.a.requestUrl+"/api/user/"+t,this.httpOptions).pipe(Object(c.a)((function(t){e.handleResponse(t)})),Object(d.a)(this.handleError("CollectionReport")))},t.prototype.getContactDetails=function(t){var e=this;return this.http.get(u.a.requestUrl+"/apis/contact/"+t,this.httpOptions).pipe(Object(c.a)((function(t){e.handleResponse(t)})),Object(d.a)(this.handleError("User")))},t.prototype.getApplyLoanDetails=function(t,e){var n=this;return this.http.get(this.requestUrl+"/"+t+"/"+e,this.httpOptions).pipe(Object(c.a)((function(t){n.handleResponse(t)})),Object(d.a)(this.handleError("CollectionReport")))},t.prototype.changeStatus=function(t,e,n,o){var r=this;return this.http.post(this.requestUrl+"/status",{status:t,apply_loan_id:e,key:n,email:o},this.httpOptions).pipe(Object(c.a)((function(t){r.handleResponse(t)})),Object(d.a)(this.handleError("CollectionReport")))},t.prototype.deleteCollectionReport=function(t){var e=this;return this.http.post(this.requestUrl+"/delete",{user_id:t},this.httpOptions).pipe(Object(c.a)((function(t){e.handleResponse(t)})),Object(d.a)(this.handleError("CollectionReport")))},t.prototype.getBasicInfo=function(t){var e=this;return this.http.get(u.a.requestUrl+"/api/admin/profile/basic_info/"+t,this.httpOptions).pipe(Object(c.a)((function(t){e.handleResponse(t)})),Object(d.a)(this.handleError("CollectionReport")))},t.prototype.getRefInfo=function(t){var e=this;return this.http.get(u.a.requestUrl+"/api/admin/profile/ref/"+t,this.httpOptions).pipe(Object(c.a)((function(t){e.handleResponse(t)})),Object(d.a)(this.handleError("User")))},t.prototype.getEmpInfo=function(t){var e=this;return this.http.get(u.a.requestUrl+"/api/admin/profile/emp_info/"+t,this.httpOptions).pipe(Object(c.a)((function(t){e.handleResponse(t)})),Object(d.a)(this.handleError("CollectionReport")))},t.prototype.getBankInfo=function(t){var e=this;return this.http.get(u.a.requestUrl+"/api/admin/profile/bank/"+t,this.httpOptions).pipe(Object(c.a)((function(t){e.handleResponse(t)})),Object(d.a)(this.handleError("CollectionReport")))},t.prototype.getKycInfo=function(t){var e=this;return this.http.get(u.a.requestUrl+"/api/admin/profile/kyc/"+t,this.httpOptions).pipe(Object(c.a)((function(t){e.handleResponse(t)})),Object(d.a)(this.handleError("CollectionReport")))},t.prototype.getBusinessDetails=function(t){var e=this;return this.http.get(u.a.requestUrl+"/api/admin/profile/business/"+t,this.httpOptions).pipe(Object(c.a)((function(t){e.handleResponse(t)})),Object(d.a)(this.handleError("User")))},t.prototype.getCollegeDetails=function(t){var e=this;return this.http.get(u.a.requestUrl+"/api/admin/profile/college/"+t,this.httpOptions).pipe(Object(c.a)((function(t){e.handleResponse(t)})),Object(d.a)(this.handleError("User")))},t.prototype.getStatus=function(){var t=this;return this.http.get(u.a.requestUrl+"/api/apply_loan/status",this.httpOptions).pipe(Object(c.a)((function(e){t.handleResponse(e)})),Object(d.a)(this.handleError("User")))},t.prototype.getUsers=function(t){var e=this;return this.http.get(u.a.requestUrl+"/api/system_report/collection/get_users/"+t,this.httpOptions).pipe(Object(c.a)((function(t){e.handleResponse(t)})),Object(d.a)(this.handleError("User")))},t.prototype.handleResponse=function(t){return t.error?this.alertService.warn("Failed: "+t.message):this.alertService.success("Success:"+t.message),t},t.prototype.handleError=function(t,e){var n=this;return void 0===t&&(t="operation"),function(o){return n.alertService.error(t+" failed: "+o.message),Object(p.a)(e)}},t.ctorParameters=function(){return[{type:l.b},{type:h.a}]},t=o.b([Object(r.C)()],t)}(),g=n("SZbH"),b=n("ZYjt"),f=n("QAmw"),y=function(){function t(t,e,n,o,r){this.route=t,this.router=e,this.collectionreportService=n,this.toastr=o,this.titleService=r,this.searchcollectionreport={loan_id:"",name:"",mobile_no:"",email:"",amount:"",collection_team:"",assigned_users:"",from_date:"",id_number:"",tenure:"",to_date:"",user_type:""},this.p=1,this.limit=10,this.user_types=[{id:0,name:"Student"},{id:1,name:"Employee"},{id:2,name:"Self Employee"}],this.tenures=[{id:1,days:7},{id:2,days:14},{id:3,days:21},{id:3,days:28}],this.amounts=[{id:1,amount:500},{id:2,amount:1e3},{id:3,amount:1500},{id:4,amount:2e3},{id:1,amount:2500},{id:2,amount:3e3},{id:3,amount:3500},{id:4,amount:4e3},{id:1,amount:4500},{id:2,amount:5e3},{id:3,amount:6500},{id:4,amount:7e3}],this.exporting=!1,this.isExport=!1,this.isShow=!1,this.titleService.setTitle("List Collection Report")}return t.prototype.ngOnInit=function(){var t=this;this.getCollectionsReportLoan(this.p),this.collectionreportService.getStatus().subscribe((function(e){e&&(t.status=e.data),t.loanStatus=t.status}))},t.prototype.getPage=function(t){this.p=t,this.isSearching?(this.isLoading=!0,this.isExport=!1,this.getFilteredData()):this.getCollectionsReportLoan(this.p)},t.prototype.getCollectionsReportLoan=function(t){var e=this,n=(t-1)*this.limit;this.isLoading=!0,this.collectionreportService.getCollectionLoanReport(n,this.limit).subscribe((function(t){e.collectionreports=t.data,e.length=e.collectionreports.length,e.total=t.total,e.isLoading=!1}))},t.prototype.reset=function(){this.limit=10,this.fieldReset(),this.isSearching=!1,this.p=1,this.total=0,this.isExport=!1,this.getPage(1)},t.prototype.fieldReset=function(){this.searchcollectionreport={loan_id:"",name:"",mobile_no:"",email:"",amount:"",collection_team:"",assigned_users:"",from_date:"",id_number:"",tenure:"",to_date:"",user_type:""}},t.prototype.onChangeCollection=function(t){var e=this;t?this.collectionreportService.getUsers(t).subscribe((function(t){e.users=t.data})):this.users=null},t.prototype.search=function(t){this.searchOptions=t,this.p=1,this.total=0,this.isSearching=!0,this.collectionreports=new Array,this.isLoading=!0,this.isExport=!1,this.getFilteredData()},t.prototype.getFilteredData=function(){var t=this,e=(this.p-1)*this.limit;this.collectionreportService.getCollectionReport(this.searchOptions,e,this.limit,this.isExport).subscribe((function(e){void 0===e&&(t.toastr.error("Record not found.","Error"),t.length=0),e&&(t.collectionreports=[].concat(e.data),t.length=e.data.length,t.total=Number(e.total||0),t.isExport&&(t.exportData=[].concat(e.data),t.downloadExportedData())),t.isLoading=!1,t.exporting=!1}),(function(e){console.log(e),t.isLoading=!1}))},t.prototype.getAllDataToExport=function(){var t=this;this.exporting=!0,this.collectionreportService.getCollectionReports().subscribe((function(e){t.exporting=!1,e.data&&e.data.length&&(t.exportData=e.data,t.downloadExportedData())}))},t.prototype.downloadExportedData=function(){var t=[];this.exportData.forEach((function(e){t.push({loan_id:e.loan_id,username:e.appUser.username,mobile_no:e.appUser.mobile_no,email:e.appUser.email,user_type:0==e.appUser.user_type?"student":"employee",required_amount:e.required_amount,disbursed_amount:e.disbursed_amount,remaining_amount:e.remaining_amount,payable_date:e.payable_date,status:e.loanStatus.status,reviewer_1:null!=e.appUserReviewer_1?e.appUserReviewer_1.firstname+" "+e.appUserReviewer_1.lastname:"Not Assigned",reviewer_2:null!=e.appUserReviewer_2?e.appUserReviewer_2.firstname+" "+e.appUserReviewer_2.lastname:"Not Assigned",customer_care:null!=e.customerCare?e.customerCare.firstname+" "+e.customerCare.lastname:"Not Assigned",s1:null!=e.S1?e.S1.firstname+" "+e.S1.lastname:"Not Assigned",s2:null!=e.S2?e.S2.firstname+" "+e.S2.lastname:"Not Assinged",s3:null!=e.S3?e.S3.firstname+" "+e.S3.lastname:"Not Assigned",m1:null!=e.M1?e.M1.firstname+" "+e.M1.lastname:"Not Assigned",m2:null!=e.M2?e.M2.firstname+" "+e.M2.lastname:"Not Assigned",collection_manager:null!=e.collectionManager?e.collectionManager.firstname+" "+e.collectionManager.lastname:"Not Assigned"})}));var e=t;new f.ngxCsv(e,"Collection Sheet",{fieldSeparator:",",quoteStrings:'"',decimalseparator:".",showLabels:!0,showTitle:!0,title:"Collection Sheet",useBom:!0,headers:["Loan Id","Customer Name","Mobile Number","Email","User Type","Required Amount","disbursed_amount","remaining_amount","payable_date","Status","reviewer_1","reviewer_2","Customer Care","S1","S2","S3","M1","M2","Collection Manager"]})},t.prototype.exportSheet=function(){this.isSearching?(this.isExport=!0,this.exporting=!0,this.getFilteredData()):this.getAllDataToExport()},t.prototype.toggleDisplay=function(){this.isShow=!this.isShow},t.ctorParameters=function(){return[{type:a.a},{type:a.f},{type:m},{type:g.b},{type:b.c}]},t=o.b([Object(r.n)({selector:"list-collection-report",template:n("jk3h")})],t)}(),v=function(){function t(t){this.collectionreportService=t}return t.prototype.resolve=function(){},t.ctorParameters=function(){return[{type:m}]},t=o.b([Object(r.C)()],t)}(),_=[{path:"",component:y,resolve:{collectionreports:v}}],S=function(){function t(){}return t=o.b([Object(r.K)({imports:[a.g.forChild(_)],exports:[a.g]})],t)}(),O=n("xkgV");n.d(e,"CollectionReportModule",(function(){return R}));var R=function(){function t(){}return t=o.b([Object(r.K)({imports:[i.b,s.a,S,O.a],providers:[m,v],declarations:[y]})],t)}()},jk3h:function(t,e){t.exports='<header class="section-header">\r\n  <div class="tbl">\r\n    <div class="tbl-row">\r\n      <div class="tbl-cell">\r\n        <h3>Collection Report</h3>\r\n        <ol class="breadcrumb breadcrumb-simple">\r\n          <li><a [routerLink]="[\'/\']">Home</a></li>\r\n          <li class="active">Collection Report</li>\r\n        </ol> \r\n      </div>\r\n    </div>\r\n  </div>\r\n</header>\r\n<section class="box-typical box-typical-padding">\r\n  <h5>Search & Filter</h5>\r\n  <form name="form" (ngSubmit)="search(f.value)" #f="ngForm" novalidate>\r\n    <div class="row">\r\n      <div class="col-md-3">\r\n        <label for="from_date">From Date</label>\r\n        <input type="date" class="form-control" #loanId name="from_date" [(ngModel)]="searchcollectionreport.from_date" #from_date="ngModel">\r\n      </div> \r\n      <div class="col-md-3">\r\n        <label for="to_date">To Date</label>\r\n        <input type="date" class="form-control" name="to_date" [(ngModel)]="searchcollectionreport.to_date" #to_date="ngModel">\r\n      </div> \r\n      <div class="col-md-3">\r\n        <label for="loan_id">Loan Id</label>\r\n        <input type="number" class="form-control" name="loan_id" [(ngModel)]="searchcollectionreport.loan_id" #loan_id="ngModel">\r\n      </div>  \r\n      <div class="col-md-3">\r\n        <label for="name">Name</label>\r\n        <input type="text" class="form-control" name="name" [(ngModel)]="searchcollectionreport.name" #name="ngModel">\r\n      </div>\r\n    </div><br>\r\n    <div class="row"> \r\n      <div class="col-md-3">\r\n        <label for="email">Email</label>\r\n        <input type="text" class="form-control" name="email" [(ngModel)]="searchcollectionreport.email" #email="ngModel">\r\n      </div>\r\n      <div class="col-md-3">\r\n        <label for="mobile_no">Mobile Number</label>\r\n        <input type="number" class="form-control" name="mobile_no" [(ngModel)]="searchcollectionreport.mobile_no" #mobile_no="ngModel">\r\n      </div>   \r\n      <div class="col-md-3">\r\n        <label for="id_number">Adhaar Number</label>\r\n        <input type="number" class="form-control" name="id_number" [(ngModel)]="searchcollectionreport.id_number" #id_number="ngModel">\r\n      </div> \r\n      <div class="col-md-3">\r\n        <label for="user_type">User Type</label> \r\n        <select class="form-control" name="user_type" [(ngModel)]="searchcollectionreport.user_type" #user_type="ngModel" required>\r\n          <option [ngValue]="null" disabled>select-user-type</option>\r\n          <option *ngFor="let userType of user_types" [ngValue]="userType.id">{{userType.name}}</option>\r\n        </select>\r\n      </div>  \r\n    </div><br>\r\n    <div class="row"> \r\n      <div class="col-md-3">\r\n        <label for="tenure">Tenure</label> \r\n         <input type="text" class="form-control" name="tenure" [(ngModel)]="searchcollectionreport.tenure" #tenure="ngModel"/>\r\n      </div>   \r\n      <div class="col-md-3">\r\n        <label for="amount">Amount</label>\r\n        <select class="form-control" name="amount" [(ngModel)]="searchcollectionreport.amount" #amount="ngModel" required>\r\n          <option [ngValue]="null" disabled>select-tenure</option>\r\n          <option *ngFor="let amount of amounts" [ngValue]="amount.amount">{{amount.amount}}</option>\r\n        </select>\r\n      </div> \r\n      <div class="col-md-3">\r\n        <label for="roles">Collection Team</label> \r\n        <select class="form-control" class="form-control" name="collection_team" [(ngModel)]="searchcollectionreport.collection_team" #collection_team="ngModel" required (change)="onChangeCollection($event.target.value)">\r\n          <option disabled>Select-Team</option>\r\n          <option value="6">Collection Manager</option>\r\n          <option value="7">Customer Support</option>\r\n          <option value="8">S1</option>\r\n          <option value="9">S2</option>\r\n          <option value="10">S3</option>\r\n          <option value="11">M1</option>  \r\n          <option value="12">M2</option>\r\n        </select>\r\n      </div>  \r\n      <div class="col-md-3">\r\n        <label for="assigned_users">Collection Users</label> \r\n        <select class="form-control" name="assigned_users" [(ngModel)]="searchcollectionreport.assigned_users" #assigned_users="ngModel" required>\r\n          <option disabled>select-status</option>\r\n          <option *ngFor="let user of users" [value]="user.id">{{user.firstname}} {{user.lastname}}</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n    <div class="row m-t-1">\r\n      <div class="col-md-2 search-button">\r\n        <button class="btn btn-primary" (click) = toggleDisplay()><i class="fa fa-search"></i> Search</button>\r\n      </div> \r\n      <div class="col-md-2 search-button">\r\n        <span (click)="reset()" class="btn btn-warning" title="Reset Filter">Reset Filter</span> \r\n      </div>\r\n      <div class="col-md-7 export-button">\r\n        <span (click)="exportSheet(collectionreports)" class="btn btn-success {{exporting ? \'is-disabled blink\' : \'\'}} {{isLoading? \'is-disabled\':\'\'}}" title="Export Report"><i class="fa fa-file-excel-o" aria-hidden="true"></i> {{!exporting ? \'Export Sheet\': \'Please Wait...\'}}</span> \r\n      </div>\r\n    </div>\r\n  </form>\r\n</section>\r\n\x3c!-- Main Content --\x3e\r\n<section class="box-typical box-typical-padding" style="height:720px;">\r\n  <table class="display table table-bordered" cellspacing="0" width="100%">\r\n    <thead>\r\n      <tr> \r\n        <th>Loan Id</th>\r\n        <th>Name</th>\r\n        <th>Mobile No</th>\r\n        <th>Email</th>\r\n        <th>Loan Type</th> \r\n        <th>Loan Amount</th> \r\n        <th>Days</th>\r\n        <th>Apply Date</th>\r\n        <th>Disbursed Date</th>  \r\n        <th>Status</th>  \r\n      </tr>\r\n    </thead>\r\n    <tbody [style.height]="isLoading? \'500px\':\'\'" [class]="isLoading ? \'vizzve-loading\': \'\'" >\r\n      <ng-container *ngFor="let collectionreport of collectionreports | paginate: { itemsPerPage: limit, currentPage: p, totalItems: total }">\r\n        <tr> \r\n          <td>\r\n            {{ collectionreport.loan_id }}\r\n          </td>\r\n          <td>\r\n            {{ collectionreport.appUser.username }}\r\n          </td>\r\n          <td>\r\n            {{ collectionreport.appUser.mobile_no }}\r\n          </td>\r\n          <td>\r\n            {{ collectionreport.appUser.email }}\r\n          </td>\r\n          <td *ngIf="collectionreport.appUser.user_type == 0">\r\n            Student\r\n          </td>\r\n          <td *ngIf="collectionreport.appUser.user_type == 1">\r\n            Employment\r\n          </td>\r\n          <td *ngIf="collectionreport.appUser.user_type == 2">\r\n            Business\r\n          </td>\r\n          <td>\r\n            {{ collectionreport.required_amount }}\r\n          </td>\r\n          <td>\r\n            {{ collectionreport.days }}\r\n          </td>\r\n          <td>\r\n            {{ collectionreport.apply_date | date: \'dd-MM-yyyy\' }}\r\n          </td>  \r\n          <td>\r\n            {{ collectionreport.disbursed_date | date: \'dd-MM-yyyy\' }}\r\n          </td>  \r\n          <td>\r\n            {{collectionreport.loanStatus.status}} \r\n          </td>   \r\n        </tr>\r\n      </ng-container>\r\n        <tr *ngIf="length == 0">\r\n          <td colspan="10" class="text-center">No records.</td>\r\n        </tr>\r\n    </tbody>\r\n  </table>\r\n  <div *ngIf="total> 10" class="pagination pagination-sm m-2 float-right {{isLoading ? \'is-disabled\': \'\'}}">\r\n    <pagination-controls (pageChange)="getPage($event)"></pagination-controls>\r\n  </div>\r\n</section>'}}]);